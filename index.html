<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>jeux_carres</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
 </head>
<body>
  <h1 class="titre"></h1>
  <section class="main">
    <form  id="formIntru">
      <fieldset>
        <legend>Voulez-vous tester vos reflexes ?</legend>
        <legend>Choississez un numero entre 3 et 30</legend>
        <input id="formIntru__nbSquare" type="number" min="3" max="30" name="carres">
        <legend>Choississez la durée de la partie en secondes</legend>
        <input id="formIntru__temps" type="number" min="2" max="10" name="temps">
        <legend>Choississez le nombre de manches</legend>
        <input id="formIntru__nbManches" type="number" min="1" max="10" name="manches">
        <input id="message" type="text" name="message" value="">
        <input id="formIntru__submit" type="submit" value="Go" onclick="launch(); printLog(); affNbCarre(); return false">
        <span id="msg" style="font-size:25px;" value=""></span>
        <div id="tab">

        </div>
      </fieldset>
    </form>

    <script type="text/javascript">
    var container=document.querySelector('#tab');
    var nbSquare="";
    var temps="";
    var nbManches="";




  



    function launch(){
      document.getElementById('message').value="";
      nbSquare=document.getElementById('formIntru__nbSquare').value;
      temps=document.getElementById('formIntru__temps').value;
      nbManches=document.getElementById('formIntru__nbManches').value;
      Timer();
    }

    function printLog(){
      console.log("nbSquare : "+nbSquare);
      console.log("temps : "+temps);
      console.log("nbManches : "+nbManches);
    }



    function affNbCarre(){
      var container=document.getElementById('tab')
      container.innerHTML="";
      var indiceIntru=Math.floor(Math.random()*nbSquare);
      for (var i = 0; i < nbSquare; i++) {
        if(i===indiceIntru){
          carre=document.createElement("button");
          carre.style.backgroundColor="#0000FF";
          carre.id="intru";
          carre.addEventListener("click", message);


        }else {
          carre=document.createElement("button");
          carre.style.backgroundColor="#FF0000";
          carre.class="perdu";
          carre.addEventListener("click", message2);
        }
        container.appendChild(carre);
      }
    }



      function message(){
        document.getElementById('message').value="Vous avez gagné";
        window.clearTimeout(timeout);
        container.innerHTML="";
      }

      function message2(){
        document.getElementById('message').value="Vous avez perdu";
         window.clearTimeout(timeout);
        document.getElementById('intru').disabled=true;
        container.innerHTML="";
      }
      

      function message3(){
        document.getElementById('message').value="Le temps est ecoulé";
        document.getElementById('intru').disabled=true;
        container.innerHTML="";
      }
    
      function Timer(){
  temps=temps-1;
  timeout=setTimeout(Timer, 1000);

  if (temps<1) {// end of timer 
    
    message3();
  }
}

</script>
</body>
</html>
